[ { "title": "Le CNED a fait Ã§a ?!", "url": "/posts/le-cned-fait-ca/", "categories": "", "tags": "article, hacking", "date": "2022-03-28 13:30:00 +0200", "snippet": "Le CnedLe CNED, pour â€œCentre National dâ€™Enseignement Ã  Distanceâ€, est un Ã©tablissement public Ã  caractÃ¨re administratif du ministÃ¨re de lâ€™Ã‰ducation nationale offrant des formations Ã  distance (merci WikipÃ©dia :b), a Ã©tÃ© et est toujours connu pour ses piÃ¨tres services de sa â€œclasse Ã  la maisonâ€, qui ont dÃ» Ãªtre utilisÃ©s pendant les confinements et les cours alternÃ©s (prÃ©sentiels + distanciels).Dans cet article, nous allons voir les diffÃ©rents problÃ¨mes rencontrÃ©s durant ces pÃ©riodes ainsi que les Ã©lÃ©ments trahissant un manque de savoir faire ou de professionnalisme dans leurs conceptions. Disclaimer: Toutes les informations rÃ©vÃ©lÃ©es dans cet article sont uniquement Ã  but informatives et Ã©ducatives et ne doivent absolument pas Ãªtre utilisÃ©es dans le but de dÃ©grader dâ€™une quelconque maniÃ¨re la plateforme. Je vous dÃ©courage ainsi de reproduire toute action de cet article et je ne saurais Ãªtre tenue responsable des consÃ©quences de vos actes ! De plus, cet article est subjectif et traduit uniquement mon point de vue en tant quâ€™Ã©lÃ¨ve et passionnÃ© dâ€™informatique, je ne suis en aucun cas un professionnel au moment oÃ¹ je rÃ©dige ces lignes.Une plateforme instable: infrastructure ou application ?Pour commencer, un petit nmap nous permet de voir que lâ€™application web est hÃ©bergÃ©e sur AWS (Amazon Web Services) et expose les ports HTTP et HTTPS (80 et 443). Ainsi, au vu des crash incessant sâ€™Ã©talant sur toute une annÃ©e, il est peu probable que cela vienne uniquement des services Amazon, mais plutÃ´t de lâ€™application elle-mÃªme (protection des serveurs, quotas, utilisation, etc.). Par application, je parle de la salle dâ€™attente mise en place suite Ã  des individus qui rejoignaient des cours en ligne pour y faire nâ€™importe quoi (et insulter les professeursâ€¦ oui, il y a des personnes dans ce monde qui nâ€™ont pas de vie â€¦). En effet, les cours en eux-mÃªmes se tenaient sur un autre service en ligne, spÃ©cialisÃ© dans le domaine, BlackBoard Collaborate (aka BBCollab), qui a Ã©tonnement plutÃ´t bien tenu le coup.De plus, rien que le code et la page web de lâ€™application nous confortent dans cette hypothÃ¨se, et ce, pour plusieurs raisons: Un site relevant de lâ€™amateurisme. DÃ¨s les premiers jours, le site arborait fiÃ¨rement le titre React App, avec un code identique Ã  celui du Getting Start de React. Attention, je ne condamne pas le fait dâ€™utiliser React, bien au contraire ! Câ€™est juste que lorsquâ€™un projet passe en production, ce genre de dÃ©tail ne doit pas rester inchangÃ© (Prenez exemple sur Netflix: il est difficile de voir quâ€™ils utilisent React !). Un site peu sÃ©curisÃ©. Mise Ã  part la faille de sÃ©curitÃ© assez importante que nous allons voir plus tard, il faut savoir que les professeurs ont accÃ¨s Ã  une instance de la salle dâ€™attente permettant de gÃ©rer les sessions Ã©lÃ¨ves (autoriser, refuser, rÃ©voquer, bannir). Le problÃ¨me avec cette session, câ€™est quâ€™elle est directement accessible via son lien, sans besoin dâ€™authentification supplÃ©mentaire. Ainsi, un seul petit manque dâ€™attention de la part du professeur durant un partage dâ€™Ã©cran et pouf toute la classe a accÃ¨s Ã  cette fenÃªtre (rip) Un site instable. En heure de pointe, la salle dâ€™attente devenait en partie voir totalement dysfonctionnel (peut-Ãªtre un problÃ¨me avec les serveurs ?). Cela se manifestait par des manques de synchronisation entre la salle dâ€™attente professeur et celles des Ã©lÃ¨ves (un Ã©lÃ¨ve pouvait Ãªtre en SdA sans pour autant que le prof le voit, ou bien ne recevait pas le lien de connexion lorsquâ€™il se faisait accepter, nÃ©cessitant alors un rafraichissement de la page) et par des erreurs de chargements lorsque les serveurs Ã©taient au plus bas.Face Ã  ces diffÃ©rents problÃ¨mes (et aux nombres importants dâ€™heures de trou que cela induisait dans mon planning), je me suis posÃ© la question: â€œNe serait-il pas possible de bypass la salle dâ€™attente ?â€. Etonnament, je ne fus pas prÃªt Ã  dÃ©couvrir ce qui suitâ€¦Des petits liens magiquesâ€¦Oui oui, câ€™est bien ce Ã  quoi vous pensez malheureusementâ€¦ Mais dÃ©taillons tout de mÃªme la dÃ©marche suivie ;-)Pendant 2 jours consÃ©cutifs, jâ€™ai enregistrÃ© Ã  lâ€™aide de Charles (application proxy sympathique) le trafic de mon ordinateur durant mes cours en ligne (enregistrement que je possÃ¨de encore Ã  ma grande surprise !). AprÃ¨s ces 48 heures de collecte de donnÃ©es, jâ€™ai Ã©pluchÃ© les logs Ã  la recherche de paternes dans les diffÃ©rentes requÃªtes tout en notant les diffÃ©rentes Ã©tapes permettant dâ€™arriver sur BBCollab.Ainsi, voici ce que jâ€™ai trouvÃ©: AprÃ¨s votre connexion sur lycee.cned.fr, vous Ãªtes redirigÃ©s dans la salle dâ€™attente. Durant le chargement de la page, le site va tout dâ€™abord rÃ©cupÃ©rer vos informations au sein de la salle dâ€™attente (nom, prÃ©nom, classe, si vous avez Ã©tÃ© acceptÃ©, etc.) puis lancer un service â€œeventâ€ permettant Ã  la page de rÃ©agir selon les actions du professeur. Enfin, si vous Ãªtes acceptez (&quot;canAccess&quot;: true), alors la page va rÃ©cupÃ©rer votre url session utilisateur BBCollab puis vous rediriger dessus.Bon, je ne dÃ©taillerai pas plus que cela les diffÃ©rentes requÃªtes sinon cela prendrait trop de temps et nâ€™apporterait pas plus dâ€™informations utiles.Maintenant que nous avons les requÃªtes Ã©lÃ¨ves, jetons un coup dâ€™oeil Ã  la salle dâ€™attente, pour voir sâ€™il nâ€™y pas dâ€™autres informations par rapport Ã  son fonctionnement. Pour cela, il suffit dâ€™ouvrir un des liens enregistrÃ©s, de faire un petit F12 et de regarder les sources. Comme vous pouvez le voir, nous avons carrÃ©ment accÃ¨s au code js non minify grÃ¢ce au source map disponible en production, ce qui simplifie grandement la comprÃ©hension du codeâ€¦ mais cela ne nous aide pas plusâ€¦ Du coup, il nous faut un accÃ¨s Ã  la page professeur, mÃªme si non fonctionnel, car il y a fort a parier quâ€™il y ait aussi la source map.Il existe plusieurs faÃ§ons de faire, personnellement jâ€™ai optÃ© pour une petite recherche Google : &quot;classevirtuelle.cned.fr/professor/&quot;. On dÃ©file un peu et voilÃ : On visite la page web et voici ce quâ€™on obtient: â€¦ et avec le F12:Ici jâ€™ai encadrÃ© les liens magiques utilisÃ©s pour envoyer des commandes Ã  la salle dâ€™attente, liens que nâ€™importe qui peut utiliser pour entre autres bypass la salle dâ€™attente. Wait ! Il y a un Bearer Token qui nous va nous empÃªcher dâ€™exÃ©cuter ces commandes ! Ca marche pas ton truc !Oui, vous avez raison, il y a un Bearer Token, mais le truc câ€™est queâ€¦ Ils ne se sont pas compliquÃ©s la vie et le uuid du token correspond tout simplement Ã  ce qui se trouve dans lâ€™url aprÃ¨s /professor/ ğŸ˜‚ (Ã  savoir que pendant les 6 premiers mois il nâ€™y avait mÃªme pas besoin de renseigner ce token :b).Ainsi, si vous possÃ¨dez lâ€™id dâ€™une personne (ou bien votre id), vous pouvez faire exactement ce que le prof peut faire, soit lâ€™accepter, etc. Mais ce nâ€™est pas tout ! Jâ€™ai gardÃ© le meilleur pour la fin !Lorsquâ€™un Ã©lÃ¨ve arrive dans la salle dâ€™attente, lâ€™application est faite de telle sorte quâ€™il faut quâ€™il envoie ses informations au serveur (pire idÃ©e ever soit dit en passant). Comme vous lâ€™avez sÃ»rement devinÃ©, cela se fait via une petite requÃªte que voici:Et voici les infos envoyÃ©es:Je vous donne dans le mille, il est possible de crÃ©er soit mÃªme des comptes Ã©lÃ¨ves. Il suffit juste de changer les valeurs name et surname par ce que lâ€™on veut et de mettre dans email une adresse mail qui nâ€™a pas encore Ã©tÃ© utilisÃ©e (elle nâ€™a mÃªme pas besoin dâ€™Ãªtre valide ! Par exemple azdDAZ865@azd79653.cazefd fonctionne parfaitement !).Mot de la finPour des raisons Ã©videntes, je ne publierai aucun script permettant dâ€™utiliser ces failles, car mon but nâ€™est pas de vous inciter Ã  les utiliser (il sâ€™agit tout de mÃªme du CNED !), mais vous laisse imaginer le champ des possibles si vous combinez le tout ;)Cet article est publiÃ© uniquement Ã  des fins Ã©ducatives, je ne saurais Ãªtre tenu pour responsable dâ€™une utilisation malveillante du contenu de cet article." }, { "title": "Planning / index", "url": "/posts/index/", "categories": "", "tags": "info, fr, en", "date": "2022-03-23 00:00:00 +0100", "snippet": " FranÃ§ais Bienvenue sur mon blog !Ici vous trouverez diverses informations par rapport aux articles prÃ©sents et Ã  venir sur le blog via ce magnifique tableau ci-dessous. Index Titre Statut Tags 0 Planning / Index PubliÃ© Informations 1 Omega et Upsilon, une dÃ©couverte RÃ©daction Article 2 Le CNED a fait Ã§a ?! RÃ©daction Article, â€œHackingâ€ 3 Never gonna give you up PrÃ©paration Article, Projet Anglais Welcome into my blog !Here you will find various information in relation to present and future articles on the blog via this magnificent table." } ]
